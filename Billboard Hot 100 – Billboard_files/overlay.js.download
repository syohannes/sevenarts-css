class PMCRedirectOverlay { constructor() { this.$ = jQuery, this.long_term_cookie_name = "pmc_reg_rd_overlay_banner", this.short_term_cookie_name = "pmc_reg_rd_overlay_banner_sesn", this.setup_hooks(), this.maybe_display_banner() } setup_hooks = () => { this.$(".pmc-reg-rd-overlay-banner .btn-close").on("click", this.hide_banner), this.$(".pmc-reg-rd-overlay-banner").on("click", "a", this.expire_session) }; hide_banner = e => { e.preventDefault(), this.$(e.target).parent().hide() }; expire_session = () => { pmc.cookie.expire(this.short_term_cookie_name) }; should_display_banner = () => { let e = pmc.cookie.get(this.long_term_cookie_name), r = pmc.is_empty(e), t = pmc.cookie.get(this.short_term_cookie_name); return r = !pmc.is_empty(t) || r, r }; set_cookies = () => { let e = pmc.cookie.get(this.long_term_cookie_name); if (!pmc.is_empty(e)) return; let r = 30; "undefined" != typeof pmc_region_redirect_overlay && void 0 !== pmc_region_redirect_overlay.dnd_duration && 0 < parseInt(pmc_region_redirect_overlay.dnd_duration) && (r = parseInt(pmc_region_redirect_overlay.dnd_duration)), r *= 86400, pmc.cookie.set(this.long_term_cookie_name, "hide", r, "/"), pmc.cookie.set(this.short_term_cookie_name, "show") }; get_current_country = () => ("undefined" != typeof pmc_fastly_geo_data && void 0 !== pmc_fastly_geo_data.country ? pmc_fastly_geo_data.country : "").toLowerCase(); get_current_language = () => "undefined" != typeof navigator && void 0 !== navigator.language ? navigator.language.split("-")[0] : ""; has_local_site = (e = "") => { if (void 0 === e || pmc.is_empty(e)) return !1; return [...pmc_region_redirect_overlay.countries, ...pmc_region_redirect_overlay.languages].includes(e) }; maybe_display_banner = () => { let e; if (e = "language" === pmc_region_redirect_overlay.redirect_type ? this.get_current_language() : this.get_current_country(), !this.should_display_banner() || !this.has_local_site(e)) return; const r = pmc_region_redirect_overlay.overlay_html[e], t = this.$("#pmc-reg-rd-overlay-banner"); t.find(".message").html(r), t.show(), this.set_cookies() } } new PMCRedirectOverlay;
